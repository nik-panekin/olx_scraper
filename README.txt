ОБЩИЕ ПОЛОЖЕНИЯ


Назначение: парсинг объявлений с сайта OLX.ua. Извлекается вся основная
информация, в том числе номера телефонов пользователей.

Для работы программы необходимо предоставить список учётных записей OLX,
с которых будет производиться авторизация для доступа к защищённым данным
через API. Дополнительные прокси не требуются, т.к., по возможности,
используются свободные TOR Proxy.

Полученные данные сохраняются в форматах JSON, CSV и XLSX. Есть возможность
сохранять также изображения из объявлений.

Программа написана на языке Python. Изначально разработана для платформы
Windows, хотя портирование под Linux особых сложностей составить не должно.


УСТАНОВКА


Для работы программы требуется установленный интерпретатор Python 3.8.10 или
более новой версии, скачать который можно с официального сайта:

    https://www.python.org/downloads/

При установке рекомендуется добавить путь к Python в переменную PATH.

Затем следует установить все библиотеки, используемые данным скриптом.
Для этого необходимо открыть командную строку из папки, куда скопированы все
файлы программы, и ввести:

    pip install -r requirements.txt

Поскольку данная программа задействует возможности TOR Proxy, а также связки
Firefox + Selenium Webdriver, необходимо убедиться, что упомянутые компоненты
установлены и к ним есть доступ из исполняемого скрипта.

Для установки TOR Proxies следует загрузить с официального сайта и распаковать
TOR Windows Expert Bundle:

    https://www.torproject.org/download/tor/

А затем соответствующим образом модифицировать константу TOR_EXECUTABLE_PATH
в файле ./utils/tor_proxy.py.

Браузер Firefox и подходящий к нему Selenium Webdriver моут быть загружены
из официальных источников Mozilla:

    https://www.mozilla.org/ru/firefox/windows/
    https://github.com/mozilla/geckodriver/releases

Замечание: после установки не забудьте прописать актуальный путь к исполняемому
файлу Webdriver в системную переменную PATH.


НАСТРОЙКА


В папке, куда устанавливается данная программа, находятся три файла, отвечающие
за её настройку:

    config.ini – основной конфигурационный файл;
    search_links.txt – категории и поисковые запросы для парсинга;
    accounts.csv – реквизиты доступа учётных записей OLX.

Файл config.ini представляет собой обычный конфигурационный ini-файл
с подробными комментариями к каждому параметру.

Файл search_links.txt — это текстовый файл, каждая строка которого представляет
собой веб-ссылку на категорию или поисковый запрос сайта OLX, где будет
осуществляться парсинг.

Замечание. Каждая из категорий парсинга не должна содержать больше 975
объявлений (39 объявлений на страницу по 25 страниц — ограничение OLX). Если
лимит превышен, следует вместо ссылки на слишком большую категорию подставить
набор ссылок, соответствующих подкатегориям нижнего уровня.

Файл accounts.csv — содержит разделённые запятой пары «логин-пароль»,
соответствующие учётным записям OLX (в одной строке — одна пара). В данной
программе они используются для получения авторизационных токенов (ключей
доступа). В настоящее время сайт OLX разрешает просмотр только 40 телефонных
номеров с одного аккаунта в сутки.


ИСПОЛЬЗОВАНИЕ


Для запуска процесса парсинга с самого начала (или принудительного удаления
ранее сохранённых данных) необходимо из папки программы открыть командную
строку и набрать:

    olx_scraper.py --reset-progress

Затем, если работа скрипта была остановлена (штатным или нештатным образом),
для продолжения парсинга достаточно ввести:

    olx_scraper.py

В ходе своей работы программой создаётся файл progress.json, где хранится
запись о текущем прогрессе процесса парсинга. Также, промежуточные результаты
периодически сохраняются в другой файл формата JSON (его имя задаётся в файле
config.ini). Удаление обоих этих файлов эквивалентно опции запуска скрипта
--reset-progress.

В папку logs ведётся запись подробного журнала сообщений и ошибок.

Результатом работы скрипта будут три файла (CSV, JSON, XLSX), пути к которым
настраиваются в файле config.ini. Также, если установлена необходимая опция,
в соответствующую папку будут сохранены изображения.

Для штатного прерывания выполнения программы следует нажать комбинацию
Ctrl + Alt + F12 (сработает, даже если приложение не в фокусе) и подождать,
пока закончится парсинг текущей страницы. Для немедленного останова (с потерей
данных) можно воспользоваться комбинацией Ctrl + Break.

Помимо прочего, в программе реализована возможность отдельной проверки
аккаунтов OLX на валидность. Для этого необходимо запустить скрипт следующим
образом:

    olx_scraper.py --check-accounts

Связь с разработчиком: nik.reflective@gmail.com
